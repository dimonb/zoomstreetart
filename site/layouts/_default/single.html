{{ define "main" }}
<article class="post">
    <header class="post-header">
        <h1>{{ .Title }}</h1>
        <div class="post-meta">
            <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "January 2, 2006" }}</time>
            {{ if .Params.author }}
            <span class="author">by {{ .Params.author }}</span>
            {{ end }}
            {{ if .Params.location }}
            <span class="location">üìç {{ .Params.location }}</span>
            {{ end }}
        </div>
        {{ if .Params.tags }}
        <div class="tags">
            {{ range .Params.tags }}
            <span class="tag">{{ . }}</span>
            {{ end }}
        </div>
        {{ end }}
    </header>

    {{ if .Params.images }}
    <div class="carousel" data-carousel>
        <div class="carousel-track" data-carousel-track>
            {{ range $index, $media := .Params.images }}
            <div class="carousel-slide" data-carousel-slide>
                {{ $ext := lower (path.Ext $media) }}
                {{ if or (eq $ext ".mp4") (eq $ext ".webm") (eq $ext ".mov") }}
                <video controls preload="metadata">
                    {{ if eq $ext ".mp4" }}
                    <source src="{{ $media }}" type="video/mp4">
                    {{ else if eq $ext ".webm" }}
                    <source src="{{ $media }}" type="video/webm">
                    {{ else if eq $ext ".mov" }}
                    <source src="{{ $media }}" type="video/quicktime">
                    {{ else }}
                    <source src="{{ $media }}">
                    {{ end }}
                    Your browser does not support the video tag.
                </video>
                {{ else }}
                <img src="{{ $media }}" alt="{{ $.Title }} image {{ add $index 1 }}" loading="lazy">
                {{ end }}
            </div>
            {{ end }}
        </div>
        <button class="carousel-control prev" data-carousel-prev aria-label="Previous slide">&#10094;</button>
        <button class="carousel-control next" data-carousel-next aria-label="Next slide">&#10095;</button>
        <div class="carousel-indicators" data-carousel-indicators>
            {{ range $index, $_ := .Params.images }}
            <button data-carousel-indicator aria-label="Go to slide {{ add $index 1 }}" {{ if eq $index 0 }}class="active"{{ end }}></button>
            {{ end }}
        </div>
    </div>
    {{ end }}

    <div class="post-content">
        {{ .Content }}
    </div>
</article>
{{ end }}
